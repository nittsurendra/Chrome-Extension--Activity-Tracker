var C=Object.defineProperty;var R=(t,e,s)=>e in t?C(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var g=(t,e,s)=>(R(t,typeof e!="symbol"?e+"":e,s),s);import"../browser-polyfill.js";import{r as E,M as D,W as A,a6 as M,b as S,S as d,n as L,a7 as O,i as k,a8 as P,B as F,g as N}from"../general.js";import{d as V,i as j,r as i,k as K,c as w,a,t as c,u as m,s as U,e as x,o as T,p as $,h as q,_ as H,x as W,y as Q}from"../i18n.js";import{P as Y}from"../PromoClearYouTube.js";function z(t,e){return E(2,arguments),D(t).getTime()-D(e).getTime()}var b={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},G="trunc";function J(t){return t?b[t]:b[G]}function y(t,e,s){E(2,arguments);var n=z(t,e)/A;return J(s==null?void 0:s.roundingMethod)(n)}class X{constructor(e,s){g(this,"domain");g(this,"time");this.domain=e,this.time=Date.now()+s*M}}async function Z(t){const e=await S.getInstance().getSetting(d.BLOCK_DEFERRAL_TIME),s=Object.values(e),n=s==null?void 0:s.find(o=>L(o.domain,t));return n!=null&&O(`Deferring time ${t} ${new Date(n.time)} diff ${y(new Date(n.time),new Date)}`),n==null?!0:n!=null&&y(new Date(n.time),new Date)>24}async function ee(t,e){const s=k(),n=await S.getInstance().getSetting(d.BLOCK_DEFERRAL_TIME),o=Object.values(n),r=o==null?void 0:o.find(u=>L(u.domain,t));r!=null?r.time=Date.now()+e*M:o.push(new X(t,5)),await s.saveValue(d.BLOCK_DEFERRAL_TIME,o)}function te(t){const e=new URL(t),s=e.searchParams.get("domain"),n=e.searchParams.get("url"),o=e.searchParams.get("favicon"),r=Number(e.searchParams.get("summaryTime")),u=Number(e.searchParams.get("summaryCounter"));return{domain:s,url:n,limitTime:r,summaryCounter:u,favicon:o}}const se=t=>($("data-v-75d4e01e"),t=t(),q(),t),ne={class:"block-container"},ae=se(()=>a("div",{class:"header"},[a("img",{class:"d-inline-block",height:"40",src:N}),a("p",{class:"d-inline-block header"},"Web Activity Time Tracker")],-1)),oe=["src"],ie={class:"source-url"},ce={class:"title"},re={class:"value"},le={class:"title"},ue={class:"value"},me=["value"],de={class:"desctiption"},ve=V({__name:"Block",setup(t){const{t:e}=j(),s=k(),n=i(),o=i(),r=i(),u=i(),_=i(),h=i(),v=i(),f=i();K(async()=>{const l=te(location.href);n.value=l.domain??"",o.value=l.url??"",r.value=l.limitTime,u.value=l.favicon??"",_.value=P(l.limitTime),h.value=l.summaryCounter??0,v.value=await s.getValue(d.BLOCK_DEFERRAL,F),f.value=await Z(n.value)});async function B(){n.value!=null&&r.value!=null&&v.value&&f.value&&(await ee(n.value,5),o.value!=""&&window.open(o.value))}return(l,p)=>(T(),w("div",ne,[ae,a("p",null,c(m(e)("block.message")),1),a("div",null,[a("img",{class:"favicon",height:"35",src:u.value},null,8,oe),a("span",null,c(n.value),1)]),a("p",ie,c(o.value),1),a("table",null,[a("tr",null,[a("td",ce,c(m(e)("limit.message"))+":",1),a("td",re,c(_.value),1)]),a("tr",null,[a("td",le,c(m(e)("sessions.message"))+":",1),a("td",ue,c(h.value),1)])]),v.value&&f.value?(T(),w("input",{key:0,type:"button",class:"mt-20",value:m(e)("5mins.message"),onClick:p[0]||(p[0]=ge=>B())},null,8,me)):U("",!0),a("p",de,c(m(e)("deferringDescription.message")),1),x(Y)]))}});const fe=H(ve,[["__scopeId","data-v-75d4e01e"]]),I=W(fe);I.use(Q);I.mount("body");
