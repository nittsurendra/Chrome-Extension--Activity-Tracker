import{B as q}from"../browser-polyfill.js";import{r as ie,t as le,c as re,a as ue,T as _e,S as m,_ as ve,i as L,C as me,b as $,d as U,I as pe,e as x,f as O,D as ge,g as ye}from"../general.js";import{a as de,s as fe,_ as Te,B as he,T as De,u as be,b as ke,c as Oe,F as we,d as Ie,e as Z,f as K,g as H,h as j,o as B,i as ee,j as te,k as Re,r as Ee}from"../dark.js";import{d as M,r as k,o as c,c as h,a as e,n as se,b as A,t as f,u as t,e as E,w as F,f as Se,g as $e,v as Pe,T as Ae,p as z,h as G,_ as V,i as W,j as Me,k as N,l as Ve,m as S,F as Y,q as ae,s as w,x as Ce,y as xe}from"../i18n.js";import{M as Be}from"../messages.js";const Fe="/assets/icons/light-mode.svg",Le="/assets/icons/dark-mode.svg",We="/assets/icons/dashboard.svg",Ne="/assets/icons/settings.svg";var Ue=36e5;function oe(o,s){ie(2,arguments);var n=le(s);return de(o,n*Ue)}function P(o,s){ie(2,arguments);var n=le(s);return de(o,n*1e3)}function ne(){return fe(Date.now())}const Ke=o=>(z("data-v-ce550e5a"),o=o(),G(),o),He={class:"expander"},je={class:"d-inline-block"},qe=Ke(()=>e("polyline",{points:"12,2 20,10 28,2","stroke-width":"3",fill:"none"},null,-1)),Ye=[qe],ze={class:"header"},Ge={class:"expander-body"},Qe={name:"Expander"},Xe=M({...Qe,props:{day:null,time:null},setup(o){const s=k();return(n,r)=>(c(),h("div",He,[e("div",{class:se(["expander-trigger",s.value?"active":"beforeBorder"]),onClick:r[0]||(r[0]=v=>s.value=!s.value)},[e("div",je,[(c(),h("svg",{class:se(["expander-trigger-Icon",{open:s.value}]),width:"40",height:"12",stroke:"cornflowerblue"},Ye,2))]),e("div",ze,[A(f(o.day)+" ",1),e("span",null,f(t(re)(o.time)),1)])],2),E(Ae,{name:"leftToRight"},{default:F(()=>[Se(e("div",Ge,[$e(n.$slots,"default",{},void 0,!0)],512),[[Pe,s.value]])]),_:3})]))}});const Je=V(Xe,[["__scopeId","data-v-ce550e5a"]]),Ze=o=>(z("data-v-fe0bbe25"),o=o(),G(),o),et={key:0,class:"no-data"},tt=Ze(()=>e("img",{height:"55",src:Ie},null,-1)),st=[tt],at={key:1},ot={key:1},nt={class:"no-data"},it=["onClick"],lt={key:2},rt={class:"date-block"},dt=["onClick"],ct=["value"],ut={class:"stats-block block"},_t={class:"header"},vt={class:"ml-20 mr-20 by-days-chart"},mt={name:"TabList"},pt=M({...mt,setup(o){const{t:s}=W(),n=k(),r=k(),v=k(),l=k(),p=ue(),b=Me(()=>n.value!=null?n.value.days.length:0);async function g(D,u){const y=await be(D,u);y!=null&&(n.value=y,y.days.length==0&&y.summaryTime==0?v.value=!0:v.value=!1),r.value=!1}async function a(D){var _,i;l.value=D;const u=(_=l.value)==null?void 0:_[0],y=(i=l.value)==null?void 0:i[1];await g(u,y)}N(async()=>{var y,_;r.value=!0,l.value=_e;const D=(y=l.value)==null?void 0:y[0],u=(_=l.value)==null?void 0:_[1];await g(D,u)});async function d(){var _,i,T;const D=(_=l.value)==null?void 0:_[0],u=(i=l.value)==null?void 0:i[1],y=await ke((T=n.value)==null?void 0:T.days);Oe(y,we.CSV,`websites_${D.toLocaleDateString()}-${u.toLocaleDateString()}.csv`)}return(D,u)=>{var _;const y=Ve("VueDatePicker");return r.value?(c(),h("div",et,st)):(c(),h("div",at,[t(b)==null||t(b)==0&&!v.value?(c(),S(Te,{key:0})):v.value?(c(),h("div",ot,[e("div",nt,[A(f(t(s)("noDataForPeriod.message"))+" ",1),E(y,{range:"","enable-time-picker":!1,class:"date-picker",modelValue:l.value,"onUpdate:modelValue":[u[0]||(u[0]=i=>l.value=i),a],"preset-ranges":t(p)},{yearly:F(({label:i,range:T,presetDateRange:I})=>[e("span",{onClick:R=>I(T)},f(i),9,it)]),_:1},8,["modelValue","preset-ranges"])])])):(c(),h("div",lt,[e("div",rt,[E(y,{range:"","enable-time-picker":!1,class:"date-picker",modelValue:l.value,"onUpdate:modelValue":[u[1]||(u[1]=i=>l.value=i),a],"preset-ranges":t(p)},{yearly:F(({label:i,range:T,presetDateRange:I})=>[e("span",{onClick:R=>I(T)},f(i),9,dt)]),_:1},8,["modelValue","preset-ranges"]),e("input",{type:"button",value:t(s)("exportToCsv.message"),onClick:u[2]||(u[2]=i=>d())},null,8,ct)]),e("div",ut,[e("div",_t,f(t(s)("averageTimeByDays.message")),1),e("p",null,f(t(re)(n.value.averageTime)),1)]),e("div",vt,[E(he,{data:n.value},null,8,["data"])]),e("div",null,[(c(!0),h(Y,null,ae((_=n.value)==null?void 0:_.days,(i,T)=>(c(),S(Je,{key:T,day:i.day,time:i.time},{default:F(()=>[(c(!0),h(Y,null,ae(i.tabs,(I,R)=>(c(),S(De,{key:R,item:I,summaryTimeForWholeDay:i.time},null,8,["item","summaryTimeForWholeDay"]))),128))]),_:2},1032,["day","time"]))),128))])]))]))}}});const gt=V(pt,[["__scopeId","data-v-fe0bbe25"]]),yt={key:0,class:"review-block"},ft=["value"],Tt={name:"Review"},ht=M({...Tt,setup(o){const{t:s}=W(),n=L(),r=12,v=2,l=5,p=k();N(async()=>{if(p.value=!1,await n.getValue(m.REVIEW_DATE)==null){let d=await n.getValue(m.REVIEW_PROMPT_AT);d==null?await n.saveValue(m.REVIEW_PROMPT_AT,Z(oe(ne(),r),v).toString()):(d=new Date(d),d<new Date&&(p.value=!0))}});async function b(){p.value=!1,await n.saveValue(m.REVIEW_PROMPT_AT,Z(oe(ne(),r),l).toString())}async function g(){window.open(me,"_blank"),await n.saveValue(m.REVIEW_DATE,new Date().toString())}return(a,d)=>p.value?(c(),h("div",yt,[e("p",null,f(t(s)("enjoyAndReview.message")),1),e("img",{height:"15",src:ve,onClick:d[0]||(d[0]=D=>b())}),e("input",{type:"button",value:t(s)("enjoyAndReview.description"),onClick:d[1]||(d[1]=D=>g())},null,8,ft)])):w("",!0)}});const Dt=V(ht,[["__scopeId","data-v-79d5e2d8"]]);async function bt(){const o="src/offscreen.html",s=q.runtime.getURL(o);await chrome.offscreen.hasDocument()||await chrome.offscreen.createDocument({url:s,reasons:["AUDIO_PLAYBACK"],justification:"Play audio sounds"})}async function kt(){let o;(_=>{_.work="WORK",_.rest="REST",_.finished="FINISH"})(o||(o={}));function s(_){let i;for(let T=1;T<=g;T++){let I=_=="WORK"?T-1:T;const R=p*I,X=(b+1)*(T-1),ce=P(l,R+X);i=P(l,R+X+p);const J=a>=ce&&(P(a,-1)<=i||a<=i);if(J)return{period:_,isTargetPeriod:J,isTargetPeriodFinishedNow:U(P(a,-1),i)||U(a,i)}}return{period:"FINISH",isTargetPeriod:!1,isTargetPeriodFinishedNow:!1}}async function n(_){function i(){switch(_){case"WORK":return m.POMODORO_AUDIO_AFTER_WORK;case"REST":return m.POMODORO_AUDIO_AFTER_REST;case"FINISH":return m.POMODORO_AUDIO_AFTER_FINISHED}}const T=await r.getValue(i());await bt(),await q.runtime.sendMessage({message:Be.PlayAudio,sound:T,offscreen:!0})}const r=L();if(!await $.getInstance().getSetting(m.IS_POMODORO_ENABLED))return;const l=new Date(await $.getInstance().getSetting(m.POMODORO_START_TIME)),p=await $.getInstance().getSetting(m.POMODORO_INTERVAL_WORK),b=await $.getInstance().getSetting(m.POMODORO_INTERVAL_REST),g=await $.getInstance().getSetting(m.POMODORO_FREQUENCY),a=new Date,d=P(l,p*g+b*g),D=await q.tabs.query({active:!0});if(a>=d){U(a,d)&&await n("FINISH"),await r.saveValue(m.IS_POMODORO_ENABLED,!1),await r.saveValue(m.POMODORO_START_TIME,null),await K({tabId:D[0].id,text:null,color:H.none,icon:j.default});return}let u=s("WORK");const y=u.isTargetPeriod;return y?await K({tabId:D[0].id,text:null,color:H.none,icon:j.pomodoroWorkingTime}):(u=s("REST"),u.isTargetPeriod&&await K({tabId:D[0].id,text:null,color:H.none,icon:j.pomodoroRestTime})),u.isTargetPeriodFinishedNow&&await n(u.period),{isWork:y}}const Ot={key:0,class:"pomodoro-popup-block"},wt={key:0},It={key:1},Rt=["value"],Et={name:"PomodoroInfo"},St=M({...Et,setup(o){const{t:s}=W(),n=L(),r=k(),v=k();return N(async()=>{var l;r.value=await n.getValue(m.IS_POMODORO_ENABLED,pe),v.value=(l=await kt())==null?void 0:l.isWork}),(l,p)=>r.value?(c(),h("div",Ot,[e("p",null,f(t(s)("pomodoroIsEnabled.message")),1),v.value?(c(),h("span",wt,f(t(s)("pomodoroWork.message")),1)):w("",!0),v.value?w("",!0):(c(),h("span",It,f(t(s)("pomodoroRest.message")),1)),e("input",{type:"button",value:t(s)("pomodoroSettings.message"),onClick:p[0]||(p[0]=b=>t(B)(t(x).Pomodoro))},null,8,Rt)])):w("",!0)}});const $t=V(St,[["__scopeId","data-v-588fc8aa"]]),C=o=>(z("data-v-b7a2b06f"),o=o(),G(),o),Pt={class:"headerBlock"},At=C(()=>e("div",{class:"d-inline-block"},[e("img",{class:"logo",height:"30",src:ye}),e("p",{class:"header"},"Web Activity Time Tracker")],-1)),Mt={class:"icons-block"},Vt=C(()=>e("img",{src:Re,height:"22"},null,-1)),Ct=C(()=>e("img",{height:"22",src:We},null,-1)),xt=C(()=>e("img",{height:"22",src:Ne},null,-1)),Bt={class:"tabs"},Ft={title:"Today"},Lt={for:"todayTab",role:"button"},Wt={title:"All The Time"},Nt={for:"allTimeTab",role:"button"},Ut={title:"By Days"},Kt={for:"byDaysTab",role:"button"},Ht=C(()=>e("div",{class:"slider"},[e("div",{class:"indicator"})],-1)),jt={class:"content"},qt={id:"todayTabList"},Yt={id:"summary"},zt={id:"byDaysTabList"},Gt=M({__name:"Popup",setup(o){const{t:s}=W(),n=L(),r=k(),v=k();N(async()=>{r.value=O.Today,v.value=await n.getValue(m.DARK_MODE,ge),v.value&&ee(v.value)});function l(g){r.value=g}async function p(g){await n.saveValue(m.DARK_MODE,g),v.value=g,ee(g),b()}function b(){const g=r.value;r.value=void 0,setTimeout(()=>{r.value=g},50)}return(g,a)=>(c(),h(Y,null,[e("div",Pt,[At,e("div",Mt,[v.value==!0?(c(),h("img",{key:0,class:"dark-mode-icon",height:"25",src:Fe,title:"Disable Dark Mode",onClick:a[0]||(a[0]=d=>p(!1))})):w("",!0),v.value==!1?(c(),h("img",{key:1,class:"dark-mode-icon",title:"Enable Dark Mode",height:"25",src:Le,onClick:a[1]||(a[1]=d=>p(!0))})):w("",!0),e("a",{onClick:a[2]||(a[2]=d=>t(B)(t(x).Pomodoro))},[A(f(t(s)("pomodoroMode.message")),1),Vt]),e("a",{class:"filter",onClick:a[3]||(a[3]=d=>t(B)(t(x).Dashboard))},[A(f(t(s)("dashboard.message")),1),Ct]),e("a",{class:"filter",onClick:a[4]||(a[4]=d=>t(B)(t(x).GeneralSettings))},[A(f(t(s)("settings.message")),1),xt])])]),e("div",Bt,[e("input",{type:"radio",id:"todayTab",name:"tab-control",checked:"",onChange:a[5]||(a[5]=d=>l(t(O).Today))},null,32),e("input",{type:"radio",id:"allTimeTab",name:"tab-control",onChange:a[6]||(a[6]=d=>l(t(O).All))},null,32),e("input",{type:"radio",id:"byDaysTab",name:"tab-control",onChange:a[7]||(a[7]=d=>l(t(O).ByDays))},null,32),e("ul",null,[e("li",Ft,[e("label",Lt,[e("span",null,f(t(s)("today.message")),1)])]),e("li",Wt,[e("label",Nt,[e("span",null,f(t(s)("allTime.message")),1)])]),e("li",Ut,[e("label",Kt,[e("span",null,f(t(s)("byDays.message")),1)])])]),Ht,e("div",jt,[e("section",qt,[r.value==t(O).Today?(c(),S(te,{key:0,type:t(O).Today,showAllStats:!1},null,8,["type"])):w("",!0)]),e("section",Yt,[r.value==t(O).All?(c(),S(te,{key:0,type:t(O).All,showAllStats:!0},null,8,["type"])):w("",!0)]),e("section",zt,[r.value==t(O).ByDays?(c(),S(gt,{key:0})):w("",!0)])])]),E($t),E(Dt)],64))}});const Qt=V(Gt,[["__scopeId","data-v-b7a2b06f"]]),Q=Ce(Qt);Q.component("VueDatePicker",Ee);Q.use(xe);Q.mount("body");
